<div class="dashboard-container">
    <header>
        <h1>IPTV Dashboard</h1>
        <nav class="main-nav">
            <button (click)="goToMovies()" class="nav-btn">Movies</button>
            <button (click)="goToSeries()" class="nav-btn">TV Series</button>
            <button (click)="logout()" class="logout-btn">Logout</button>
        </nav>
    </header>

    <div class="controls">
        <div class="filter-group">
            <label for="category">Category:</label>
            <select id="category" [(ngModel)]="selectedCategoryId" (change)="onCategoryChange()">
                <option value="">All Categories</option>
                <option *ngFor="let cat of categories" [value]="cat.category_id">
                    {{ cat.category_name }}
                </option>
            </select>
        </div>
        <div class="filter-group">
            <label for="search">Search:</label>
            <input type="text" id="search" placeholder="Search channels..." (input)="onSearch($event)"
                class="search-input">
        </div>
        <div class="stats">
            Showing {{ (currentPage - 1) * pageSize + 1 }}-{{ (currentPage * pageSize) > filteredStreams.length ?
            filteredStreams.length : (currentPage * pageSize) }} of {{ filteredStreams.length }} streams
        </div>
    </div>

    <div class="content" *ngIf="!loading; else loader">
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Icon</th>
                        <th>Name</th>
                        <th>Category ID</th>
                        <th>Stream Type</th>
                        <th>Direct Source</th>
                        <th>Archive</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let stream of paginatedStreams" (click)="playStream(stream)" class="clickable-row">
                        <td>
                            <img [src]="stream.stream_icon" alt="" class="channel-icon"
                                onerror="this.style.display='none'" *ngIf="stream.stream_icon">
                        </td>
                        <td>{{ stream.name }}</td>
                        <td>{{ stream.category_id }}</td>
                        <td>{{ stream.stream_type }}</td>
                        <td>{{ stream.direct_source }}</td>
                        <td>{{ stream.tv_archive ? 'Yes' : 'No' }}</td>
                    </tr>
                    <tr *ngIf="filteredStreams.length === 0">
                        <td colspan="6" class="no-data">No streams found in this category.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="pagination" *ngIf="totalPages > 1">
            <button (click)="prevPage()" [disabled]="currentPage === 1" class="page-btn">Previous</button>
            <span class="page-info">Page {{ currentPage }} of {{ totalPages }}</span>
            <button (click)="nextPage()" [disabled]="currentPage === totalPages" class="page-btn">Next</button>
        </div>
    </div>

    <ng-template #loader>
        <div class="loader">Loading content...</div>
    </ng-template>
</div>